# Spin Wheel (New Year) — Bangkok Hospital Hat Yai Theme

Single‑page web app (client‑side only) สำหรับสุ่มรางวัลแบบวงล้อ (Spin Wheel) พร้อม UI ตาม CI โรงพยาบาล (โทนสีน้ำเงิน/แดง) และฟีเจอร์ Export รายชื่อผู้ได้รับรางวัลเป็นไฟล์ `.xlsx`

---

## ไฟล์ในชุดนี้
- `index.html` — ไฟล์เดียว เปิดใช้งานได้ทันที (HTML/CSS/JS อยู่ในไฟล์เดียว)
- `README.md` — คู่มือการใช้งานฉบับย่อ (ไฟล์นี้)

---

## วิธีใช้งาน (เร็วที่สุด)
1. ดาวน์โหลด `index.html`
2. ดับเบิลคลิกเปิดด้วย Chrome / Edge (หรือเปิดผ่าน Browser อื่นได้)
3. ไปที่แท็บ **รายชื่อ**
4. กด **โหลดรายชื่อ / เริ่มต้นใหม่** เพื่อเริ่มรอบใหม่
5. กลับไปแท็บ **วงล้อ** แล้วกด **หมุนวงล้อ** หรือคลิกวงล้อ

> หมายเหตุ: แอปทำงานแบบ client‑side 100% ไม่ต้องมี server

---

## ฟีเจอร์หลัก
- วงล้อบน `<canvas>` (Responsive รองรับ Desktop/Mobile)
- Pointer อยู่ด้านบน (12 นาฬิกา) ปลายแหลม **ชี้ลงเข้าวงล้อ**
- การหมุนแบบ Smooth (Cubic ease‑out)
- สุ่มแบบปลอดภัย: `crypto.getRandomValues()` + rejection sampling (ลด bias)
- หลังวงล้อหยุด:
  - ชื่อผู้ชนะถูก **ตัดออกจากวงล้อทันที** (Realtime)
  - ถูกย้ายไปส่วน **ผู้ได้รับรางวัล**
  - แสดง Popup พร้อมเอฟเฟกต์พลุ
- **ผลล่าสุด (Last Winner)** แสดงในหน้า “วงล้อ”
- เมื่อกด **โหลดรายชื่อ / เริ่มต้นใหม่**
  - จะ **ล้างผลล่าสุด** (Last Winner) ทันที
  - Reset ผู้ได้รับรางวัลและเริ่มรอบใหม่

---

## การจัดการรายชื่อ
### 1) แก้ไขผ่าน Textarea
- ไปที่แท็บ **รายชื่อ**
- วางรายชื่อ “คนละบรรทัด”
- กด **โหลดรายชื่อ / เริ่มต้นใหม่**

### 2) นำเข้าไฟล์ `.txt` หรือ `.csv`
- กดปุ่ม **นำเข้าไฟล์รายชื่อ** แล้วเลือกไฟล์
- จากนั้นกด **โหลดรายชื่อ / เริ่มต้นใหม่**

### 3) รายชื่อ Default
- ภายใน `index.html` มีตัวแปร `DEFAULT_NAMES_TEXT` ซึ่งถูกฝังไว้ให้เป็นค่าเริ่มต้น
- หากต้องการเปลี่ยนรายชื่อ Default:
  - เปิด `index.html` ด้วย Text Editor
  - ค้นหา `DEFAULT_NAMES_TEXT`
  - แทนที่ข้อความภายใน backticks (`` `...` ``) ด้วยรายชื่อใหม่ (คนละบรรทัด)

---

## Export รายชื่อผู้ได้รับรางวัลเป็น Excel (.xlsx)
- ไปที่แท็บ **รายชื่อ**
- กด **Export ผู้ได้รับรางวัล (.xlsx)**
- ระบบจะสร้างไฟล์ `.xlsx` เฉพาะรายชื่อผู้ได้รับรางวัล (Winners) เท่านั้น

> หมายเหตุ: เป็นการสร้างไฟล์ OOXML `.xlsx` แบบ client‑side (ไม่ใช้ library ภายนอก)

---

## การบันทึกสถานะ (Local Storage)
- แอปจะเก็บ:
  - รายชื่อผู้เข้าร่วม (participants)
  - รายชื่อผู้ได้รับรางวัล (winners)
  - มุมวงล้อ (currentAngle)
- เก็บไว้ใน `localStorage` ของ Browser เพื่อกลับมาใช้งานต่อได้เมื่อรีเฟรชหน้า

### เคลียร์ข้อมูลทั้งหมด
- ไปที่แท็บ **รายชื่อ** แล้วกด **ล้างทั้งหมด**
- หรือเคลียร์ `localStorage` ของเว็บไซต์/ไฟล์นี้จาก Browser settings

---

## ปรับโลโก้
- โลโก้ถูกโหลดจาก URL ที่กำหนดไว้ใน `DEFAULT_LOGO_URL`
- หากต้องการเปลี่ยน:
  - ค้นหา `DEFAULT_LOGO_URL` ใน `index.html`
  - เปลี่ยนเป็น URL ใหม่

> แนะนำให้ใช้ URL ที่เข้าถึงได้โดยตรง (Direct image URL) และเปิดได้จากทุกเครื่องในงาน

---

## Troubleshooting
- **เปิดแล้วโลโก้ไม่ขึ้น**
  - ตรวจสอบว่า URL เป็นลิงก์รูปที่เข้าถึงได้ (บางลิงก์ต้อง login หรือมีสิทธิ์)
- **รายชื่อเยอะ 700–800 คน อ่านยาก**
  - โค้ดใช้โหมดสี Pastel และลดความถี่การวาดตัวอักษรอัตโนมัติเมื่อชื่อมีจำนวนมาก (เพื่อ performance)
- **ต้องการเริ่มใหม่จริง ๆ**
  - กด **โหลดรายชื่อ / เริ่มต้นใหม่** (จะเคลียร์ผู้ชนะ + เคลียร์ผลล่าสุด)
  - หรือกด **ล้างทั้งหมด**

---

## หมายเหตุด้านความเป็นส่วนตัว
- ข้อมูลทั้งหมดอยู่ในเครื่องของผู้ใช้ (Browser) ไม่มีการส่งออกไปที่ server โดยอัตโนมัติ

---
